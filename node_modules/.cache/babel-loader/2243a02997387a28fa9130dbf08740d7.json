{"ast":null,"code":"import _classCallCheck from\"/home/paulo/gh-pages/TrybeTunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/paulo/gh-pages/TrybeTunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/paulo/gh-pages/TrybeTunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/paulo/gh-pages/TrybeTunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/paulo/gh-pages/TrybeTunes/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{addSong,removeSong,getFavoriteSongs}from'../services/favoriteSongsAPI';import Loading from'../pages/Loading';import'../css/MusicCard.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MusicCard=/*#__PURE__*/function(_React$Component){_inherits(MusicCard,_React$Component);var _super=_createSuper(MusicCard);function MusicCard(props){var _this;_classCallCheck(this,MusicCard);_this=_super.call(this,props);_this.state={loading:false,favorites:[]};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.getFavs=_this.getFavs.bind(_assertThisInitialized(_this));_this.favCheckbox=_this.favCheckbox.bind(_assertThisInitialized(_this));return _this;}_createClass(MusicCard,[{key:\"componentDidMount\",value:function componentDidMount(){this.getFavs();}},{key:\"handleChange\",value:function handleChange(_ref){var _this2=this;var target=_ref.target;var _this$props=this.props,music=_this$props.music,onChange=_this$props.onChange;this.setState({loading:true});if(target.checked){addSong(music).then(function(){_this2.setState({loading:false});});}else{removeSong(music).then(function(){_this2.setState({loading:false});});}this.getFavs();onChange();}},{key:\"getFavs\",value:function getFavs(){var _this3=this;getFavoriteSongs().then(function(songs){_this3.setState({favorites:songs});});}},{key:\"favCheckbox\",value:function favCheckbox(trackId,favorites){var checked=favorites.some(function(song){return song.trackId===trackId;});return/*#__PURE__*/_jsxs(\"label\",{htmlFor:trackId,children:[/*#__PURE__*/_jsx(\"span\",{className:\"no-display\",children:\"Favorita\"}),/*#__PURE__*/_jsx(\"i\",{className:\"\".concat(checked?'fas text-danger':'far',\" fa-heart\")}),/*#__PURE__*/_jsx(\"input\",{id:trackId,type:\"checkbox\",name:\"favorite\",\"data-testid\":\"checkbox-music-\".concat(trackId),onChange:this.handleChange,checked:checked,className:\"d-none\"})]});}},{key:\"render\",value:function render(){var _this$props$music=this.props.music,trackName=_this$props$music.trackName,previewUrl=_this$props$music.previewUrl,trackId=_this$props$music.trackId;var _this$state=this.state,loading=_this$state.loading,favorites=_this$state.favorites;return/*#__PURE__*/_jsxs(\"section\",{className:\"row ms-2 my-2 border rounded align-items-center cardColor ps-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"col-5 h6 m-0 p-0\",children:trackName}),/*#__PURE__*/_jsxs(\"audio\",{className:\"col-5 p-0\",\"data-testid\":\"audio-component\",src:previewUrl,controls:true,children:[/*#__PURE__*/_jsx(\"track\",{kind:\"captions\"}),\"O seu navegador n\\xE3o suporta o elemento\",/*#__PURE__*/_jsx(\"code\",{children:\"audio\"}),\".\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-2 text-center p-0\",children:loading?/*#__PURE__*/_jsx(Loading,{}):this.favCheckbox(trackId,favorites)})]});}}]);return MusicCard;}(React.Component);MusicCard.defaultProps={onChange:function onChange(){}};export default MusicCard;","map":{"version":3,"sources":["/home/paulo/gh-pages/TrybeTunes/src/components/MusicCard.jsx"],"names":["React","addSong","removeSong","getFavoriteSongs","Loading","MusicCard","props","state","loading","favorites","handleChange","bind","getFavs","favCheckbox","target","music","onChange","setState","checked","then","songs","trackId","some","song","trackName","previewUrl","Component","defaultProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport { addSong, removeSong, getFavoriteSongs } from '../services/favoriteSongsAPI';\nimport Loading from '../pages/Loading';\nimport '../css/MusicCard.css';\n\nclass MusicCard extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      favorites: [],\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.getFavs = this.getFavs.bind(this);\n    this.favCheckbox = this.favCheckbox.bind(this);\n  }\n\n  componentDidMount() {\n    this.getFavs();\n  }\n\n  handleChange({ target }) {\n    const { music, onChange } = this.props;\n    this.setState({\n      loading: true,\n    });\n    if (target.checked) {\n      addSong(music).then(() => {\n        this.setState({ loading: false });\n      });\n    } else {\n      removeSong(music).then(() => {\n        this.setState({ loading: false });\n      });\n    }\n    this.getFavs();\n    onChange();\n  }\n\n  getFavs() {\n    getFavoriteSongs().then((songs) => {\n      this.setState({ favorites: songs });\n    });\n  }\n\n  favCheckbox(trackId, favorites) {\n    const checked = favorites.some((song) => song.trackId === trackId);\n    return (\n      <label htmlFor={ trackId }>\n        <span className=\"no-display\">Favorita</span>\n        <i className={ `${checked ? 'fas text-danger' : 'far'} fa-heart` } />\n        <input\n          id={ trackId }\n          type=\"checkbox\"\n          name=\"favorite\"\n          data-testid={ `checkbox-music-${trackId}` }\n          onChange={ this.handleChange }\n          checked={ checked }\n          className=\"d-none\"\n        />\n      </label>\n    );\n  }\n\n  render() {\n    const { music: { trackName, previewUrl, trackId } } = this.props;\n    const { loading, favorites } = this.state;\n    return (\n      <section className=\"row ms-2 my-2 border rounded align-items-center cardColor ps-4\">\n        <span className=\"col-5 h6 m-0 p-0\">{ trackName }</span>\n        <audio\n          className=\"col-5 p-0\"\n          data-testid=\"audio-component\"\n          src={ previewUrl }\n          controls\n        >\n          <track kind=\"captions\" />\n          O seu navegador n√£o suporta o elemento\n          <code>audio</code>\n          .\n        </audio>\n        <div className=\"col-2 text-center p-0\">\n          {loading ? <Loading />\n            : this.favCheckbox(trackId, favorites)}\n        </div>\n      </section>\n    );\n  }\n}\n\nMusicCard.propTypes = {\n  music: PropTypes.shape({\n    trackName: PropTypes.string.isRequired,\n    previewUrl: PropTypes.string.isRequired,\n    trackId: PropTypes.number.isRequired,\n  }).isRequired,\n  onChange: PropTypes.func,\n};\n\nMusicCard.defaultProps = {\n  onChange: () => {},\n};\n\nexport default MusicCard;\n"]},"metadata":{},"sourceType":"module"}